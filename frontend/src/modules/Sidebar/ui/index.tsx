import { NavLink, useNavigate } from "react-router-dom";
import { memo, ReactNode, useEffect } from "react";
import { useGetMe } from "@/modules/Login/api/useGetMe.ts";

interface Route {
  link: string;
  name: string;
  icon: ReactNode;
}

const Sidebar = memo(() => {
  const routes: Route[] = [
    {
      link: "/",
      name: "Новости",
      icon: (
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          strokeWidth={1.5}
          stroke="currentColor"
          className="w-6 h-6"
        >
          <path
            strokeLinecap="round"
            strokeLinejoin="round"
            d="M12 7.5h1.5m-1.5 3h1.5m-7.5 3h7.5m-7.5 3h7.5m3-9h3.375c.621 0 1.125.504 1.125 1.125V18a2.25 2.25 0 0 1-2.25 2.25M16.5 7.5V18a2.25 2.25 0 0 0 2.25 2.25M16.5 7.5V4.875c0-.621-.504-1.125-1.125-1.125H4.125C3.504 3.75 3 4.254 3 4.875V18a2.25 2.25 0 0 0 2.25 2.25h13.5M6 7.5h3v3H6v-3Z"
          />
        </svg>
      ),
    },
    {
      link: "/profile",
      name: "Профиль",
      icon: (
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          strokeWidth={1.5}
          stroke="currentColor"
          className="w-6 h-6"
        >
          <path
            strokeLinecap="round"
            strokeLinejoin="round"
            d="M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"
          />
        </svg>
      ),
    },
    {
      link: "/messenger",
      name: "Мессенджер",
      icon: (
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          strokeWidth={1.5}
          stroke="currentColor"
          className="w-6 h-6"
        >
          <path
            strokeLinecap="round"
            strokeLinejoin="round"
            d="M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193-.34.027-.68.052-1.02.072v3.091l-3-3c-1.354 0-2.694-.055-4.02-.163a2.115 2.115 0 0 1-.825-.242m9.345-8.334a2.126 2.126 0 0 0-.476-.095 48.64 48.64 0 0 0-8.048 0c-1.131.094-1.976 1.057-1.976 2.192v4.286c0 .837.46 1.58 1.155 1.951m9.345-8.334V6.637c0-1.621-1.152-3.026-2.76-3.235A48.455 48.455 0 0 0 11.25 3c-2.115 0-4.198.137-6.24.402-1.608.209-2.76 1.614-2.76 3.235v6.226c0 1.621 1.152 3.026 2.76 3.235.577.075 1.157.14 1.74.194V21l4.155-4.155"
          />
        </svg>
      ),
    },
  ];
  const { data, isPending, isSuccess } = useGetMe();
  const navigate = useNavigate();
  useEffect(() => {
    if (!isSuccess && !isPending) navigate("/login");
  }, [isSuccess, isPending]);

  const orgs = {
    link: "/organizations",
    name: "Организации",
    icon: (
      <svg
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 24 24"
        strokeWidth={1.5}
        stroke="currentColor"
        className="w-6 h-6"
      >
        <path
          strokeLinecap="round"
          strokeLinejoin="round"
          d="M12 21v-8.25M15.75 21v-8.25M8.25 21v-8.25M3 9l9-6 9 6m-1.5 12V10.332A48.36 48.36 0 0 0 12 9.75c-2.551 0-5.056.2-7.5.582V21M3 21h18M12 6.75h.008v.008H12V6.75Z"
        />
      </svg>
    ),
  };
  return (
    <div className="overflow-hidden group h-[100vh] transition-all duration-200 w-[20vw] px-2 z-20 flex  items-start justify-center py-3 bg-white fixed top-0 left-0 backdrop-blur-2xl">
      <nav className="flex flex-col gap-2 w-full">
        <h2 className="w-full font-bold text-xl my-2">TULA-HACK</h2>
        {data?.data.kind !== "user"
          ? routes.map((el) => (
              <NavLink
                key={el.link}
                to={el.link}
                className={({ isActive }) =>
                  `flex p-2 w-full rounded-full transition-all duration-200 hover:bg-violet-50 hover:text-violet-700 ${
                    isActive && "bg-violet-50 text-violet-700 "
                  }`
                }
              >
                {el.icon}
                <span className=" duration-100 ml-4 transition-all whitespace-nowrap h-full">
                  {el.name}
                </span>
              </NavLink>
            ))
          : [...routes, orgs].map((el) => (
              <NavLink
                key={el.link}
                to={el.link}
                className={({ isActive }) =>
                  `flex p-2 w-full rounded-full transition-all duration-200 hover:bg-violet-50 hover:text-violet-700 ${
                    isActive && "bg-violet-50 text-violet-700 "
                  }`
                }
              >
                {el.icon}
                <span className=" duration-100 ml-4 transition-all whitespace-nowrap h-full">
                  {el.name}
                </span>
              </NavLink>
            ))}
      </nav>
    </div>
  );
});

export default Sidebar;
